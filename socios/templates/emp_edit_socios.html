{% extends 'base.html' %}
{% load static %}

{% block content %}

<html>

<head>
    <title>Editar Socio</title>
    <style>
   
    </style>
</head>

<body>
    <div class="content-menu" style="padding-top: 0%;">
        <div class="header">
            <h1>Editar Socio</h1>
        </div>
        <div class="content">
            <div class="form-container">
                <form id="socio-form" action="{% url 'editar_socio' socio_id=socio.id %}" method="POST"
                    enctype="multipart/form-data">
                    {% csrf_token %}

                    <label for="first_name">Nombre:</label>
                    <input type="text" id="first_name" name="first_name" value="{{ socio.user.first_name }}" required>

                    <label for="last_name">Apellido:</label>
                    <input type="text" id="last_name" name="last_name" value="{{ socio.user.last_name }}" required>

                    <label for="cedula">Cedula:</label>
                    <input type="text" pattern="[0-9]{1,10}" maxlength="10" value="{{ socio.cedula }}" inputmode="numeric"
                        id="cedula" name="cedula" required>

                    <label for="fecha_nacimiento">Fecha de Nacimiento:</label>
                    <input type="date" id="fecha_nacimiento" name="fecha_nacimiento"
                        value="{{ socio.fecha_nacimiento|date:'Y-m-d' }}" required>

                    <label for="lugar_nacimiento">Lugar de Nacimiento:</label>
                    <input type="text" id="lugar_nacimiento" name="lugar_nacimiento"
                        value="{{ socio.lugar_nacimiento }}" required>



                    <label for="email">Correo Electrónico:</label>
                    <input type="email" id="email" name="email"
                        value="{{ socio.user.email }}" required>

                    <label for="numero_telefonico">Teléfono:</label>
                    <input type="number" id="numero_telefonico" name="numero_telefonico"
                        value="{{ socio.numero_telefonico }}" required>

                    <label for="numero_convencional">Teléfono Convencional:</label>
                    <input type="number" id="numero_convencional" name="numero_convencional"
                        value="{{ socio.numero_convencional }}" required>

                    <label for="direccion_domiciliaria">Dirección Domiciliaria:</label>
                    <input type="text" id="direccion_domiciliaria" name="direccion_domiciliaria"
                        value="{{ socio.direccion_domiciliaria }}" required>

                    <label for="facultad">Facultad:</label>
                    <select id="facultad" name="facultad" required placeholder="Seleccione la facultad"
                        value="{{ socio.facultad }}" style="width:100%;">
                        <option value="" disabled selected>Seleccionar Facultad</option>
                            {% for facultad in facultades %}
                            <option value="{{ facultad.nombre_facu }}"{% if socio.facultad == facultad.nombre_facu %}selected{% endif %}>{{ facultad.nombre_facu }}</option>
                            {% endfor %}    
                    </select>
                    <label for="categoria">Categoría:</label>
                    <select id="categoria" name="categoria" required style="width:100%;">
                        <option value="" disabled selected>Seleccionar Categoría</option>
                            {% for categoria in categorias %}
                            <option value="{{ categoria.nombre_cat }}"{% if socio.categoria == categoria.nombre_cat %}selected{% endif %}>{{ categoria.nombre_cat }}</option>
                            {% endfor %}
                    </select>
                    
                    <label for="dedicacion_academica">Dedicación Académica:</label>
                    <select id="dedicacion" name="dedicacion_academica" required style="width:100%;">
                        <option value="" disabled selected>Seleccionar Dedicación</option>
                        {% for dedicacion in dedicacionAcademica %}
                        <option value="{{ dedicacion.nombre_de }}"{% if socio.dedicacion_academica == dedicacion.nombre_de %}selected{% endif %}>{{ dedicacion.nombre_de }}</option>
                        {% endfor %}
                    </select>
                    

                    <label for="titulo">Título:</label>
                    <select id="titulo" name="titulo" required style="width:100%;">
                        <option value="" disabled selected>Seleccionar Título</option>
                        {% for titulo in titulos %}
                        <option value="{{ titulo.nombre_ti }}"{% if socio.titulo == titulo.nombre_ti %}selected{% endif %}>{{ titulo.nombre_ti }}</option>
                        {% endfor %}
                    </select>


                    <label for="foto">Agregar foto de Perfil:</label>
                 
                    {% get_media_prefix as media_prefix %}
                    <div class="generated-credentials">           
                        <div class="custom-file">
                            <div class="upload-preview">
                                <div id="imagePreview">
                                    <img src="{{ media_prefix }}{{ socio.foto }}" alt="">
                                </div>
                            </div>
                            <input type="file" class="custom-file-input" id="foto" name="foto" 
                                onchange="previewImage(event)" >
                            <label class="custom-file-label" for="id_foto_perfil">Seleccionar imagen</label>
                        </div>
                    </div>

      
                    <!-- <div class="generated-credentials">
                        <label for="username" style="margin-left: 5px;">Nombre de Usuario:</label>
                        <input type="text" id="username" name="username" value="{{ socio.user.username }}" required>
                        <label for="password">Contraseña:</label>
                        <div style="position: relative;">
                            <input type="password" id="password" name="password" required>
                            <span id="tgl_password" class="fas fa-eye-slash"
                                style="position: absolute; right: 20px;top: 25%; cursor: pointer;"></span>
                        </div>
                        <button type="button" id="generate-credentials" style="width: 50%; margin-bottom: 10px;">Generar
                            Credenciales</button>

                    </div> -->
                    <input type="hidden" id="aporte" name="aporte" value="{{ socio.aporte }}">


                    <button type="submit" style="width: 100%;">
                        Guardar cambios
                    </button>
                    <a href="/socios"> <input type="button" value="Cancelar"
                            style="width: 100%; background-color: red;"></a>


                </form>
            </div>
        </div>
    </div>
    <script>
        // Generar usuario y contraseña al hacer clic en el botón
        const generateCredentialsButton = document.getElementById('generate-credentials');
        generateCredentialsButton.addEventListener('click', function () {
            // Generar usuario
            const nombre = document.getElementById('nombres').value;
            const apellido = document.getElementById('apellidos').value;
            const indiceEspacio = apellido.indexOf(' ');

            const usuario = (nombre.charAt(0) + apellido.substring(0, indiceEspacio)).toLowerCase();

            // Generar contraseña
            const caracteres = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let contrasena = '';
            for (let i = 0; i < 8; i++) {
                const randomIndex = Math.floor(Math.random() * caracteres.length);
                contrasena += caracteres.charAt(randomIndex);
            }

            // Mostrar usuario y contraseña generados
            const generatedUsername = document.getElementById('usuario');
            const generatedPassword = document.getElementById('password');
            generatedUsername.value = usuario;
            generatedPassword.value = contrasena;

        });
    </script>
    <script>
        function previewImage(event) {
            var reader = new FileReader();
            reader.onload = function () {
                var imagePreview = document.getElementById('imagePreview');
                imagePreview.innerHTML = '<img src="' + reader.result + '" style="width: 100%;">';
            };
            reader.readAsDataURL(event.target.files[0]);
        }
    </script>
</body>

</html>






{% endblock %}